<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Image Editor â€” Office Tools</title>
  <meta name="description" content="Edit images online: crop, adjust brightness, contrast, make black & white, flip, rotate, and more. Free browser-based image editor.">
  <meta name="keywords" content="image editor, online image editing, crop image, adjust brightness, contrast, black and white image, flip image, rotate image, edit photo">
  <meta name="robots" content="index, follow">
  <meta property="og:title" content="Image Editor - Free Online Image Editing">
  <meta property="og:description" content="Crop, adjust brightness/contrast, convert to black & white, flip, rotate and moreâ€”free online image editor.">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <style>
    :root {
      --accent:#0b84ff;
      --bg:#ffffff;
      --card:#ffffff;
      --text:#111111;
      --muted:#566173;
      --border:#e5e7eb;
      --shadow:0 8px 24px rgba(10,20,40,.08);
      --menu-bg:#ffffff;
      --success:#22c55e;
    }
    [data-theme="dark"]{
      --bg:#0b0f15;
      --card:#0e141c;
      --text:#f1f5f9;
      --muted:#cbd5e1;
      --border:#1f2a37;
      --shadow:0 18px 40px rgba(0,0,0,.55);
      --menu-bg:#101823;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);}
    a{color:inherit;text-decoration:none}
    header{position:sticky;top:0;z-index:1000;background:var(--card);box-shadow:var(--shadow)}
    .nav{display:flex;align-items:center;justify-content:space-between;max-width:1200px;margin:0 auto;padding:.7rem 1rem;gap:12px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand-badge{width:36px;height:36px;border-radius:9px;background:var(--accent);display:grid;place-items:center;color:#fff;font-weight:800}
    .brand-name{font-weight:800;font-size:1.05rem}
    .menu{display:flex;gap:10px;align-items:center}
    .menu > li{list-style:none;position:relative}
    .menu > li > a{padding:.55rem .8rem;border-radius:8px;display:flex;align-items:center;gap:6px}
    .menu > li:hover > a{background:rgba(11,132,255,.08)}
    .submenu{display:none;position:absolute;top:calc(100% + 6px);left:0;background:var(--menu-bg);border:1px solid var(--border);border-radius:10px;box-shadow:var(--shadow);min-width:220px;max-height:60vh;overflow:auto;z-index:1001}
    .submenu a{display:block;padding:.6rem .9rem;border-bottom:1px solid rgba(0,0,0,.04)}
    .submenu a:last-child{border-bottom:none}
    .menu > li:hover .submenu{display:block}
    .spacer{flex:1}
    .toggle{border:1px solid var(--border);background:transparent;color:var(--text);padding:.45rem .8rem;border-radius:8px;cursor:pointer}
    main{max-width:1200px;margin:1.5rem auto;padding:0 1rem}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);padding:24px;}
    .editor-area{display:flex;flex-wrap:wrap;gap:32px;align-items:flex-start;}
    .editor-canvas-wrap{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:16px;min-width:300px;text-align:center;}
    .editor-controls{flex:1;min-width:300px;display:flex;flex-direction:column;gap:24px;}
    label{display:block;font-size:.9rem;color:var(--muted);margin-bottom:6px}
    input[type="range"]{width:100%;}
    .control-block{margin-bottom:18px;}
    .btn-row{display:flex;gap:12px;margin-top:12px;}
    .primary{background:var(--accent);color:#fff;border:none;border-radius:8px;padding:.6rem 1.1rem;cursor:pointer;font-weight:500}
    .primary:disabled{background:var(--muted);cursor:not-allowed}
    .secondary{background:transparent;color:var(--accent);border:1px solid var(--accent);border-radius:8px;padding:.6rem 1.1rem;cursor:pointer;font-weight:500}
    .preview-img{max-width:100%;max-height:450px;border-radius:10px;box-shadow:var(--shadow);margin:0 auto;}
    .footer{padding:20px;text-align:center;color:var(--muted);margin-top:32px;}
    .ad-block{margin:2rem 0;text-align:center;}
    .ad-placeholder{border:1px dashed var(--border);border-radius:8px;padding:40px 12px;color:var(--muted)}
    @media (max-width: 900px) {
      .editor-area{flex-direction:column;align-items:stretch;}
      .editor-canvas-wrap{min-width:100%;}
      .editor-controls{min-width:100%;}
    }
  </style>
</head>
<body>
  <header>
    <nav class="nav">
      <div class="brand">
        <div class="brand-badge">OT</div>
        <div class="brand-name">Office Tools</div>
      </div>
      <ul class="menu">
        <li><a href="index.html">Home</a></li>
        <li>
          <a href="#">PDF Tools â–¾</a>
          <div class="submenu">
            <a href="#">PDF Compressor</a>
            <a href="#">PDF Editor</a>
            <a href="#">PDF to Image</a>
            <a href="#">PDF to Word</a>
            <a href="#">PDF to Excel</a>
          </div>
        </li>
        <li>
          <a href="#">Excel Tools â–¾</a>
          <div class="submenu">
            <a href="#">Excel to PDF</a>
            <a href="xls-to-xlsx.html">XLS to XLSX</a>
          </div>
        </li>
        <li>
          <a href="#">Image Tools â–¾</a>
          <div class="submenu">
            <a href="img-compress.html">Image Compressor</a>
            <a href="img-editor.html">Image Editor</a>
            <a href="#">Image to PDF</a>
          </div>
        </li>
      </ul>
      <div class="spacer"></div>
      <button id="modeToggle" class="toggle" type="button">ðŸŒ™ Dark</button>
    </nav>
  </header>

  <main>
    <div class="card">
      <h1 style="margin:0 0 8px 0">Image Editor</h1>
      <p style="color:var(--muted);margin-bottom:24px">Upload and edit your image in-browser. Crop, adjust brightness and contrast, convert to black & white, flip, rotate, and more.</p>

      <div class="editor-area">
        <div class="editor-canvas-wrap">
          <canvas id="editorCanvas" width="400" height="400" style="background:#f7fafc;display:none"></canvas>
          <img id="previewImg" class="preview-img" style="display:none" alt="Preview">
          <div id="emptyCanvasMsg">No image uploaded.<br><button id="uploadBtn" class="primary" type="button">Upload Image</button></div>
          <input type="file" id="fileInput" accept="image/*" style="display:none">
        </div>
        <div class="editor-controls">
          <div class="control-block">
            <label>Crop tool</label>
            <button id="cropBtn" class="secondary" type="button">Crop</button>
          </div>
          <div class="control-block">
            <label for="brightness">Brightness</label>
            <input id="brightness" type="range" min="50" max="150" value="100">
          </div>
          <div class="control-block">
            <label for="contrast">Contrast</label>
            <input id="contrast" type="range" min="50" max="150" value="100">
          </div>
          <div class="control-block">
            <label for="bw">Black & White</label>
            <button id="bwBtn" class="secondary" type="button">Toggle</button>
          </div>
          <div class="control-block">
            <label>Flip/Rotate</label>
            <div class="btn-row">
              <button id="flipHBtn" class="secondary" type="button">Flip Horizontal</button>
              <button id="flipVBtn" class="secondary" type="button">Flip Vertical</button>
              <button id="rotate90Btn" class="secondary" type="button">Rotate 90Â°</button>
            </div>
          </div>
          <div class="control-block">
            <label>Clear/Reset/Download</label>
            <div class="btn-row">
              <button id="clearBtn" class="secondary" type="button">Clear</button>
              <button id="resetBtn" class="secondary" type="button">Reset Adjustments</button>
              <button id="downloadBtn" class="primary" type="button">Download</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Google AdSense Placeholder -->
    <div class="ad-block">
      <div class="ad-placeholder">
        <!-- Replace with your Google AdSense code -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXX" crossorigin="anonymous"></script>
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXX"
             data-ad-slot="XXXXXXXXX"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        <!-- Fallback placeholder for demo -->
        <div style="padding:40px;border:1px dashed var(--border);border-radius:8px;">Google AdSense Advertisement Placeholder<br><small>Replace with your actual AdSense code</small></div>
      </div>
    </div>
  </main>

  <footer>
    <div class="footer">&copy; <span id="year"></span> Office Tools. All rights reserved.</div>
  </footer>

  <script>
    // Dark mode toggle + year label
    (function(){
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const saved = localStorage.getItem('theme');
      const initial = saved || (prefersDark ? 'dark' : 'light');
      const root = document.documentElement;
      const btn = document.getElementById('modeToggle');
      function apply(theme){
        root.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        btn.textContent = theme === 'dark' ? 'â˜€ï¸ Light' : 'ðŸŒ™ Dark';
      }
      apply(initial);
      btn.addEventListener('click', () => {
        const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        apply(next);
      });
      document.getElementById('year').textContent = new Date().getFullYear();
    })();

    // === Image Editor functionality ===
    const fileInput = document.getElementById('fileInput');
    const previewImg = document.getElementById('previewImg');
    const editorCanvas = document.getElementById('editorCanvas');
    const ctx = editorCanvas.getContext('2d');
    const emptyCanvasMsg = document.getElementById('emptyCanvasMsg');
    const uploadBtn = document.getElementById('uploadBtn');
    let img = null;
    let originalImage = null;
    let workingCanvas = null;
    let blackWhiteMode = false;
    let cropMode = false;
    let cropping = false;
    let cropStart = null, cropRect = null;

    // Draw workingCanvas onto editorCanvas
    function drawWorkingCanvas() {
      if (workingCanvas) {
        editorCanvas.width = workingCanvas.width;
        editorCanvas.height = workingCanvas.height;
        ctx.drawImage(workingCanvas, 0, 0);
      }
    }

    // Show canvas and hide empty block
    function showCanvas() {
      editorCanvas.style.display = "";
      previewImg.style.display = "none";
      emptyCanvasMsg.style.display = "none";
    }

    uploadBtn.addEventListener('click', ()=>fileInput.click());
    fileInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if(file){
        const reader = new FileReader();
        reader.onload = function(ev){
          img = new Image();
          img.onload = ()=> {
            editorCanvas.width = img.width;
            editorCanvas.height = img.height;
            ctx.drawImage(img, 0, 0);
            workingCanvas = document.createElement("canvas");
            workingCanvas.width = img.width;
            workingCanvas.height = img.height;
            workingCanvas.getContext("2d").drawImage(img,0,0);
            originalImage = document.createElement("canvas");
            originalImage.width = img.width;
            originalImage.height = img.height;
            originalImage.getContext("2d").drawImage(img,0,0);

            blackWhiteMode = false;
            document.getElementById('brightness').value=100;
            document.getElementById('contrast').value=100;
            showCanvas();
          };
          img.src = ev.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    // Editor logic: always work on workingCanvas!
    function applyEditor() {
      if (!originalImage) return;
      let temp = document.createElement('canvas');
      temp.width = originalImage.width;
      temp.height = originalImage.height;
      temp.getContext('2d').drawImage(originalImage,0,0);

      let tctx = temp.getContext('2d');
      let imageData = tctx.getImageData(0,0,temp.width,temp.height);
      let d = imageData.data;
      const brightness = document.getElementById('brightness').value/100;
      const contrast = document.getElementById('contrast').value/100;

      for(let i=0;i<d.length;i+=4){
        d[i] = Math.min(255, Math.max(0, d[i]*brightness));
        d[i+1] = Math.min(255, Math.max(0, d[i+1]*brightness));
        d[i+2] = Math.min(255, Math.max(0, d[i+2]*brightness));
        d[i] = ((d[i]-128)*contrast)+128;
        d[i+1] = ((d[i+1]-128)*contrast)+128;
        d[i+2] = ((d[i+2]-128)*contrast)+128;
      }
      tctx.putImageData(imageData,0,0);

      // If blackWhiteMode, apply that now
      if (blackWhiteMode) {
        let imgData = tctx.getImageData(0, 0, temp.width, temp.height);
        let d2 = imgData.data;
        for(let j=0;j<d2.length;j+=4){
          let avg = (d2[j]+d2[j+1]+d2[j+2])/3;
          d2[j]=d2[j+1]=d2[j+2]=avg;
        }
        tctx.putImageData(imgData,0,0);
      }

      workingCanvas.width = temp.width;
      workingCanvas.height = temp.height;
      workingCanvas.getContext('2d').drawImage(temp,0,0);
      drawWorkingCanvas();
    }

    document.getElementById('brightness').addEventListener('input', applyEditor);
    document.getElementById('contrast').addEventListener('input', applyEditor);

    document.getElementById('bwBtn').addEventListener('click', ()=>{
      if(!originalImage) return;
      blackWhiteMode = !blackWhiteMode;
      applyEditor();
    });

    document.getElementById('resetBtn').addEventListener('click', ()=>{
      if(originalImage) {
        blackWhiteMode = false;
        document.getElementById('brightness').value=100;
        document.getElementById('contrast').value=100;
        workingCanvas.width = originalImage.width;
        workingCanvas.height = originalImage.height;
        workingCanvas.getContext('2d').drawImage(originalImage,0,0);
        drawWorkingCanvas();
      }
    });

    document.getElementById('clearBtn').addEventListener('click', ()=>{
      img = null;
      originalImage = null;
      workingCanvas = null;
      editorCanvas.style.display = 'none';
      previewImg.style.display = 'none';
      emptyCanvasMsg.style.display = '';
      fileInput.value = '';
      document.getElementById('brightness').value=100;
      document.getElementById('contrast').value=100;
      blackWhiteMode = false;
    });

    // ====== Crop Logic - one box only while dragging ======
    document.getElementById('cropBtn').addEventListener('click', ()=>{
      if (!workingCanvas) return;
      cropMode = true;
      cropping = false;
      alert('Click and drag on the image to select crop area.');
    });

    editorCanvas.addEventListener('mousedown', function(e){
      if(!cropMode) return;
      cropping = true;
      const rect = editorCanvas.getBoundingClientRect();
      cropStart = {x: e.clientX - rect.left, y: e.clientY - rect.top};
      cropRect = null;
    });

    editorCanvas.addEventListener('mousemove', function(e){
      if(!cropMode || !cropping) return;
      const rect = editorCanvas.getBoundingClientRect();
      let mouseX = e.clientX - rect.left;
      let mouseY = e.clientY - rect.top;
      cropRect = {
        x: Math.min(mouseX, cropStart.x),
        y: Math.min(mouseY, cropStart.y),
        w: Math.abs(mouseX - cropStart.x),
        h: Math.abs(mouseY - cropStart.y)
      };
      // Always repaint from workingCanvas, then draw one current rectangle
      drawWorkingCanvas();
      if(cropRect.w && cropRect.h){
        ctx.save();
        ctx.strokeStyle = "#0b84ff";
        ctx.lineWidth = 2;
        ctx.strokeRect(cropRect.x,cropRect.y,cropRect.w,cropRect.h);
        ctx.restore();
      }
    });
    editorCanvas.addEventListener('mouseup', function(e){
      if(!cropMode || !cropRect || !cropping) { cropMode=false; cropping=false; return; }
      // Commit the crop
      let tCanvas = document.createElement('canvas');
      tCanvas.width = cropRect.w;
      tCanvas.height = cropRect.h;
      tCanvas.getContext('2d').drawImage(editorCanvas, cropRect.x, cropRect.y, cropRect.w, cropRect.h, 0, 0, cropRect.w, cropRect.h);
      // Update all held buffers
      editorCanvas.width = tCanvas.width;
      editorCanvas.height = tCanvas.height;
      ctx.drawImage(tCanvas,0,0);
      workingCanvas.width = tCanvas.width;
      workingCanvas.height = tCanvas.height;
      workingCanvas.getContext('2d').drawImage(tCanvas,0,0);
      originalImage.width = tCanvas.width;
      originalImage.height = tCanvas.height;
      originalImage.getContext('2d').drawImage(tCanvas,0,0);
      cropStart = cropRect = null;
      cropMode=false;
      cropping=false;
    });

    // Flip/rotate and Download
    document.getElementById('flipHBtn').addEventListener('click', ()=>{
      if(!workingCanvas) return;
      let temp = document.createElement('canvas');
      temp.width = workingCanvas.width;
      temp.height = workingCanvas.height;
      let tctx = temp.getContext('2d');
      tctx.translate(temp.width,0);
      tctx.scale(-1,1);
      tctx.drawImage(workingCanvas,0,0);
      workingCanvas.width = temp.width;
      workingCanvas.height = temp.height;
      workingCanvas.getContext('2d').drawImage(temp,0,0);
      drawWorkingCanvas();
    });
    document.getElementById('flipVBtn').addEventListener('click', ()=>{
      if(!workingCanvas) return;
      let temp = document.createElement('canvas');
      temp.width = workingCanvas.width;
      temp.height = workingCanvas.height;
      let tctx = temp.getContext('2d');
      tctx.translate(0,temp.height);
      tctx.scale(1,-1);
      tctx.drawImage(workingCanvas,0,0);
      workingCanvas.width = temp.width;
      workingCanvas.height = temp.height;
      workingCanvas.getContext('2d').drawImage(temp,0,0);
      drawWorkingCanvas();
    });
    document.getElementById('rotate90Btn').addEventListener('click', ()=>{
      if(!workingCanvas) return;
      let temp = document.createElement('canvas');
      temp.width = workingCanvas.height;
      temp.height = workingCanvas.width;
      let tctx = temp.getContext('2d');
      tctx.save();
      tctx.translate(temp.width,0);
      tctx.rotate(Math.PI/2);
      tctx.drawImage(workingCanvas,0,0);
      tctx.restore();
      workingCanvas.width = temp.width;
      workingCanvas.height = temp.height;
      workingCanvas.getContext('2d').drawImage(temp,0,0);
      drawWorkingCanvas();
    });

    document.getElementById('downloadBtn').addEventListener('click', ()=>{
      if(!workingCanvas) return;
      const link = document.createElement('a');
      link.download = "edited-image.png";
      link.href = workingCanvas.toDataURL("image/png");
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });
  </script>
</body>
</html>
