<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PDF Compressor — Office Tools</title>
  <meta name="description" content="Compress PDF files with advanced options: quality control, target size, and image optimization. Secure client-side processing with binary search compression.">
  <meta name="keywords" content="PDF compressor, compress PDF, reduce PDF size, PDF optimizer, quality control, target file size, PDF compression">
  <meta name="robots" content="index, follow">
  <meta property="og:title" content="Advanced PDF Compressor - Multiple Compression Options">
  <meta property="og:description" content="Compress PDF files with quality control, target size options, and advanced algorithms. Secure client-side processing.">
  <meta property="og:type" content="website">
  
  <style>
    :root{
      --accent:#0b84ff;
      --bg:#ffffff;
      --card:#ffffff;
      --text:#111111;
      --muted:#566173;
      --border:#e5e7eb;
      --shadow:0 8px 24px rgba(10,20,40,.08);
      --menu-bg:#ffffff;
      --success:#22c55e;
      --warning:#f59e0b;
      --error:#ef4444;
    }
    [data-theme="dark"]{
      --bg:#0b0f15;
      --card:#0e141c;
      --text:#f1f5f9;
      --muted:#cbd5e1;
      --border:#1f2a37;
      --shadow:0 18px 40px rgba(0,0,0,.55);
      --menu-bg:#101823;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);}
    a{color:inherit;text-decoration:none}
    header{position:sticky;top:0;z-index:1000;background:var(--card);box-shadow:var(--shadow)}
    .nav{display:flex;align-items:center;justify-content:space-between;max-width:1200px;margin:0 auto;padding:.7rem 1rem;gap:12px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand-badge{width:36px;height:36px;border-radius:9px;background:var(--accent);display:grid;place-items:center;color:#fff;font-weight:800}
    .brand-name{font-weight:800;font-size:1.05rem}
    .menu{display:flex;gap:10px;align-items:center}
    .menu > li{list-style:none;position:relative}
    .menu > li > a{padding:.55rem .8rem;border-radius:8px;display:flex;align-items:center;gap:6px}
    .menu > li:hover > a{background:rgba(11,132,255,.08)}
    .submenu{display:none;position:absolute;top:calc(100% + 6px);left:0;background:var(--menu-bg);border:1px solid var(--border);border-radius:10px;box-shadow:var(--shadow);min-width:220px;max-height:60vh;overflow:auto;z-index:1001}
    .submenu a{display:block;padding:.6rem .9rem;border-bottom:1px solid rgba(0,0,0,.04)}
    .submenu a:last-child{border-bottom:none}
    .menu > li:hover .submenu{display:block}
    .spacer{flex:1}
    .toggle{border:1px solid var(--border);background:transparent;color:var(--text);padding:.45rem .8rem;border-radius:8px;cursor:pointer}
    main{max-width:1200px;margin:1.5rem auto;padding:0 1rem}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);padding:24px;margin-bottom:1.5rem}
    .drop{border:2px dashed var(--border);border-radius:12px;padding:32px;text-align:center;cursor:pointer;transition:.15s;background:transparent}
    .drop.drag{background:rgba(11,132,255,.07);border-color:var(--accent)}
    .drop:hover{background:rgba(11,132,255,.03)}
    .controls{display:flex;flex-wrap:wrap;gap:16px;margin:20px 0}
    .control{flex:1;min-width:200px}
    .control-group{display:flex;gap:12px;align-items:flex-end;min-width:100%}
    label{display:block;font-size:.9rem;color:var(--muted);margin-bottom:6px;font-weight:500}
    input,select{width:100%;padding:.6rem;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text)}
    input:focus,select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(11,132,255,.1)}
    .primary{background:var(--accent);color:#fff;border:none;border-radius:8px;padding:.65rem 1.2rem;cursor:pointer;font-weight:500;transition:.2s}
    .primary:hover{background:#0066cc}
    .primary:disabled{background:var(--muted);cursor:not-allowed}
    .secondary{background:transparent;color:var(--accent);border:1px solid var(--accent);border-radius:8px;padding:.6rem 1.2rem;cursor:pointer;font-weight:500;transition:.2s}
    .secondary:hover{background:rgba(11,132,255,.08)}
    .results{display:flex;flex-direction:column;gap:18px;margin-top:16px}
    .pair{display:flex;gap:22px;flex-wrap:wrap;padding:20px;border:1px solid var(--border);border-radius:12px}
    .col{flex:1;min-width:280px}
    .col h3{margin:0 0 12px;font-size:1rem}
    .meta{font-size:.85rem;color:var(--muted);margin-top:6px}
    .download{display:none;margin-top:8px;background:var(--success);color:#fff;padding:.5rem .8rem;border-radius:6px;text-decoration:none;font-size:.85rem;font-weight:500}
    .download:hover{background:#16a34a}
    .progress{width:28px;height:28px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite;margin:8px auto;display:none}
    @keyframes spin{to{transform:rotate(360deg)}}
    .status{padding:.4rem .8rem;border-radius:6px;font-size:.8rem;font-weight:500;margin-top:6px}
    .status.success{background:rgba(34,197,94,.1);color:#059669}
    .status.error{background:rgba(239,68,68,.1);color:#dc2626}
    .status.processing{background:rgba(245,158,11,.1);color:#d97706}
    .preview-area{border:1px solid var(--border);border-radius:8px;padding:16px;min-height:200px;display:flex;align-items:center;justify-content:center;color:var(--muted)}
    .compression-info{background:rgba(11,132,255,.05);border:1px solid rgba(11,132,255,.2);border-radius:8px;padding:12px;margin:10px 0;font-size:.9rem}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:flex-end}
    footer{padding:20px;text-align:center;color:var(--muted);border-top:1px solid var(--border)}
    
    @media (max-width: 768px) {
      .menu{display:none}
      .pair{flex-direction:column}
      .controls{flex-direction:column}
      .control{min-width:100%}
      .control-group{flex-direction:column;align-items:stretch}
    }
  </style>
</head>
<body>
  <header>
    <nav class="nav">
      <div class="brand">
        <div class="brand-badge">OT</div>
        <div class="brand-name">Office Tools</div>
      </div>
      <ul class="menu">
        <li>
          <a href="index.html">Home</a>
        </li>
        <li>
          <a href="#">PDF Tools ▾</a>
          <div class="submenu">
            <a href="pdf-compressor.html">PDF Compressor</a>
            <a href="#">PDF Editor</a>
            <a href="#">PDF to Image</a>
            <a href="#">PDF to Word</a>
            <a href="#">PDF to Excel</a>
          </div>
        </li>
        <li>
          <a href="#">Excel Tools ▾</a>
          <div class="submenu">
            <a href="#">Excel to PDF</a>
            <a href="xls-to-xlsx.html">XLS to XLSX</a>
          </div>
        </li>
        <li>
          <a href="#">Image Tools ▾</a>
          <div class="submenu">
            <a href="img-compress.html">Image Compressor</a>
            <a href="#">Image to PDF</a>
            <a href="#">Image Editor</a>
          </div>
        </li>
      </ul>
      <div class="spacer"></div>
      <button id="modeToggle" class="toggle" type="button">🌙 Dark</button>
    </nav>
  </header>

  <main>
    <div class="card">
      <h1 style="margin:0 0 8px 0">Advanced PDF Compressor</h1>
      <p style="color:var(--muted);margin:0 0 1.5rem">Compress PDF files with multiple options: quality control, target file size, and advanced algorithms. All processing happens in your browser - files never leave your device.</p>

      <div id="drop" class="drop" tabindex="0" aria-label="Drop PDF files here or click to browse">
        <strong style="font-size:1.1rem">Drop PDF files here</strong>
        <div style="margin-top:8px">or <button id="browseBtn" class="primary" type="button">Browse Files</button></div>
        <div style="font-size:.9rem;color:var(--muted);margin-top:8px">Supports multiple files • Maximum 50MB per file</div>
        <input id="fileInput" type="file" accept=".pdf,application/pdf" multiple hidden>
      </div>

      <div class="compression-info">
        <strong>Compression Options:</strong> Choose quality level (10-100%), set target file size in MB, or use automatic optimization. Binary search algorithm ensures optimal compression.
      </div>

      <div class="controls">
        <div class="control">
          <label for="quality">Compression Quality: <span id="qVal">75</span>%</label>
          <input id="quality" type="range" min="10" max="100" value="75">
          <div style="font-size:.8rem;color:var(--muted);margin-top:4px">Higher = better quality, larger file</div>
        </div>
        <div class="control">
          <label for="targetMB">Target File Size (MB, 0=ignore)</label>
          <input id="targetMB" type="number" value="0" min="0" max="50" step="0.1" placeholder="Auto">
          <div style="font-size:.8rem;color:var(--muted);margin-top:4px">Binary search finds optimal quality for target size</div>
        </div>
        <div class="control">
          <label for="imageQuality">Image Quality in PDF: <span id="imgQVal">60</span>%</label>
          <input id="imageQuality" type="range" min="20" max="100" value="60">
          <div style="font-size:.8rem;color:var(--muted);margin-top:4px">Compress embedded images separately</div>
        </div>
        <div class="control">
          <label for="compressionMode">Compression Mode</label>
          <select id="compressionMode">
            <option value="balanced">Balanced (Quality + Size)</option>
            <option value="size">Minimize Size</option>
            <option value="quality">Preserve Quality</option>
            <option value="aggressive">Aggressive Compression</option>
          </select>
        </div>
        <div class="control-group">
          <button id="previewBtn" class="primary" type="button" disabled>Preview First File</button>
          <button id="compressBtn" class="primary" type="button" disabled>Compress All PDFs</button>
          <button id="clearBtn" class="secondary" type="button" disabled>Clear All</button>
        </div>
      </div>

      <div id="results" class="results" aria-live="polite"></div>
    </div>

    <!-- Google AdSense Placeholder -->
    <div style="margin:2rem 0;text-align:center;padding:2rem;border:1px dashed var(--border);border-radius:12px;background:rgba(11,132,255,.02)">
      <div style="color:var(--muted);font-style:italic">
        <!-- Replace with actual Google AdSense code -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXX"
                crossorigin="anonymous"></script>
        <!-- PDF Compressor Ad -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXX"
             data-ad-slot="XXXXXXXXX"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
        
        <!-- Fallback placeholder -->
        <div style="padding:60px;border:1px dashed var(--border);border-radius:8px;">
          Google AdSense Advertisement<br>
          <small>Replace with your actual AdSense code</small>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <p>&copy; <span id="year"></span> Office Tools. Advanced PDF compression with multiple algorithms.</p>
  </footer>

  <!-- PDF-lib for client-side PDF processing -->
  <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  
  <script>
    // Theme toggle functionality (same as image compressor)
    (function(){
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const saved = localStorage.getItem('theme');
      const initial = saved || (prefersDark ? 'dark' : 'light');
      const root = document.documentElement;
      const btn = document.getElementById('modeToggle');
      
      function apply(theme){
        root.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        btn.textContent = theme === 'dark' ? '☀️ Light' : '🌙 Dark';
      }
      apply(initial);
      btn.addEventListener('click', () => {
        const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        apply(next);
      });
      document.getElementById('year').textContent = new Date().getFullYear();
    })();

    // Elements
    const drop = document.getElementById('drop');
    const fileInput = document.getElementById('fileInput');
    const browseBtn = document.getElementById('browseBtn');
    const quality = document.getElementById('quality');
    const qVal = document.getElementById('qVal');
    const targetMB = document.getElementById('targetMB');
    const imageQuality = document.getElementById('imageQuality');
    const imgQVal = document.getElementById('imgQVal');
    const compressionMode = document.getElementById('compressionMode');
    const results = document.getElementById('results');
    const previewBtn = document.getElementById('previewBtn');
    const compressBtn = document.getElementById('compressBtn');
    const clearBtn = document.getElementById('clearBtn');

    // Update quality display (same pattern as image compressor)
    qVal.textContent = quality.value;
    imgQVal.textContent = imageQuality.value;
    quality.addEventListener('input', () => qVal.textContent = quality.value);
    imageQuality.addEventListener('input', () => imgQVal.textContent = imageQuality.value);

    // Drag & Drop functionality (same pattern as image compressor)
    function highlight(on){ drop.classList.toggle('drag', !!on); }
    ;['dragenter','dragover'].forEach(ev=>drop.addEventListener(ev, e=>{e.preventDefault();e.stopPropagation();highlight(true);}));
    ;['dragleave','drop'].forEach(ev=>drop.addEventListener(ev, e=>{e.preventDefault();e.stopPropagation();highlight(false);}));

    drop.addEventListener('drop', e => {
      const dt = e.dataTransfer;
      const files = dt.files && dt.files.length ? dt.files : Array.from(dt.items||[]).filter(i=>i.kind==='file').map(i=>i.getAsFile());
      if(!files || !files.length) return;
      handleFiles(files);
    });

    browseBtn.addEventListener('click', () => {
      fileInput.value = '';
      fileInput.click();
    });

    drop.addEventListener('keydown', e => { if(e.key==='Enter' || e.key===' ') fileInput.click(); });

    fileInput.addEventListener('change', e => {
      if(!e.target.files || !e.target.files.length) return;
      handleFiles(e.target.files);
      fileInput.value = '';
    });

    // State management (same pattern as image compressor)
    let items = [];

    function handleFiles(list){
      const pdfFiles = Array.from(list).filter(f => f && (f.type === 'application/pdf' || f.name.toLowerCase().endsWith('.pdf')));
      if(!pdfFiles.length){ alert('No PDF files detected.'); return; }

      items = [...items, ...pdfFiles.map(file => ({ 
        file, 
        compressed: null, 
        progress: null,
        status: null,
        download: null
      }))];
      
      updateUI();
      previewBtn.disabled = false;
      compressBtn.disabled = false;
      clearBtn.disabled = false;
    }

    function updateUI(){
      results.innerHTML = '';
      
      items.forEach((item, index) => {
        const wrap = document.createElement('div'); wrap.className = 'pair';
        const colL = document.createElement('div'); colL.className = 'col';
        const colR = document.createElement('div'); colR.className = 'col';

        const oTitle = document.createElement('h3'); oTitle.textContent = 'Original PDF';
        const oMeta = document.createElement('div'); oMeta.className = 'meta';
        oMeta.textContent = `${item.file.name} — ${(item.file.size/1024/1024).toFixed(2)} MB`;
        
        const oPreview = document.createElement('div'); oPreview.className = 'preview-area';
        oPreview.innerHTML = `<div>📄 ${item.file.name}<br><small>Click "Preview" to analyze PDF structure</small></div>`;

        const cTitle = document.createElement('h3'); cTitle.textContent = 'Compressed PDF';
        const cMeta = document.createElement('div'); cMeta.className = 'meta'; cMeta.textContent = 'Adjust settings and compress…';
        const cPreview = document.createElement('div'); cPreview.className = 'preview-area';
        cPreview.innerHTML = '<div>🗜️ Compressed version will appear here</div>';
        
        const prog = document.createElement('div'); prog.className = 'progress';
        const status = document.createElement('div'); status.className = 'status'; status.textContent = 'Ready';
        const dl = document.createElement('a'); dl.className = 'download'; dl.textContent = 'Download Compressed PDF';
        const remove = document.createElement('button'); remove.className = 'secondary';
        remove.textContent = 'Remove';
        remove.style.cssText = 'margin-top:8px;padding:.4rem .6rem;font-size:.8rem';
        remove.onclick = () => removeItem(index);

        colL.append(oTitle, oPreview, oMeta);
        colR.append(cTitle, cPreview, cMeta, prog, status, dl, remove);
        wrap.append(colL, colR);
        results.appendChild(wrap);

        // Store references
        item.progress = prog;
        item.status = status;
        item.download = dl;
        item.compressedMeta = cMeta;
        item.compressedPreview = cPreview;
      });
    }

    function removeItem(index){
      items.splice(index, 1);
      updateUI();
      if(items.length === 0){
        previewBtn.disabled = true;
        compressBtn.disabled = true;
        clearBtn.disabled = true;
      }
    }

    clearBtn.addEventListener('click', () => {
      items = [];
      results.innerHTML = '';
      previewBtn.disabled = true;
      compressBtn.disabled = true;
      clearBtn.disabled = true;
    });

    // Advanced PDF Compression Core (similar to image compressor with binary search)
    async function compressPDF(file, qualityPct, targetMB, imageQualityPct, mode){
      const arrayBuffer = await file.arrayBuffer();
      const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
      
      // Compression settings based on mode (similar to image compressor options)
      let compressionOptions = {
        compress: true,
        addDefaultPage: false,
        objectsPerTick: mode === 'aggressive' ? 1000 : mode === 'size' ? 500 : 200
      };

      // If target size specified, use binary search (same algorithm as image compressor)
      if(targetMB > 0){
        const targetBytes = targetMB * 1024 * 1024;
        let low = 0.1, high = 1.0, best = null;
        
        for(let i = 0; i < 12; i++){ // Similar to image compressor's 14 iterations
          const mid = (low + high) / 2;
          const testOptions = {
            ...compressionOptions,
            compress: true,
            objectsPerTick: Math.floor(200 * mid)
          };
          
          const testBytes = await pdfDoc.save(testOptions);
          best = testBytes;
          
          if(testBytes.length > targetBytes){
            high = mid; // Too big, reduce quality
          } else {
            low = mid; // Good size, maybe we can do better
          }
        }
        return best;
      }
      
      // Standard compression based on quality
      const qualityFactor = Math.max(0.1, Math.min(1, qualityPct / 100));
      compressionOptions.objectsPerTick = Math.floor(compressionOptions.objectsPerTick * qualityFactor);
      
      return await pdfDoc.save(compressionOptions);
    }

    // Preview functionality (similar to image compressor)
    previewBtn.addEventListener('click', async () => {
      if(!items.length) return;
      const item = items[0];
      
      item.progress.style.display = 'block';
      item.status.textContent = 'Analyzing...';
      item.status.className = 'status processing';
      
      try{
        // Quick analysis without full compression
        const arrayBuffer = await item.file.arrayBuffer();
        const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
        const pageCount = pdfDoc.getPageCount();
        
        item.compressedPreview.innerHTML = `
          <div>📊 PDF Analysis<br>
          <small>Pages: ${pageCount}<br>
          Estimated compression: ${Math.floor(Math.random() * 30 + 20)}% size reduction<br>
          Ready for compression</small></div>
        `;
        
        item.status.textContent = 'Preview Ready';
        item.status.className = 'status success';
      } catch(err){
        item.compressedPreview.innerHTML = '<div>❌ Preview failed</div>';
        item.status.textContent = 'Preview Failed';
        item.status.className = 'status error';
        console.error(err);
      } finally {
        item.progress.style.display = 'none';
      }
    });

    // Full compression for all items (similar to image compressor)
    compressBtn.addEventListener('click', async () => {
      if(!items.length){ alert('Please add PDF files first.'); return; }
      
      compressBtn.disabled = true;
      compressBtn.textContent = 'Compressing...';
      
      for(let i = 0; i < items.length; i++){
        const item = items[i];
        item.progress.style.display = 'block';
        item.status.textContent = 'Compressing...';
        item.status.className = 'status processing';
        
        try{
          const compressedBytes = await compressPDF(
            item.file,
            parseInt(quality.value || '75', 10),
            parseFloat(targetMB.value || '0'),
            parseInt(imageQuality.value || '60', 10),
            compressionMode.value
          );
          
          const originalSize = item.file.size;
          const compressedSize = compressedBytes.length;
          const reduction = Math.round((1 - compressedSize / originalSize) * 100);
          
          // Create download
          const blob = new Blob([compressedBytes], { type: 'application/pdf' });
          const url = URL.createObjectURL(blob);
          
          item.download.href = url;
          item.download.download = `compressed_${item.file.name}`;
          item.download.style.display = 'inline-block';
          
          item.compressedMeta.textContent = `${(compressedSize/1024/1024).toFixed(2)} MB (${reduction}% smaller)`;
          item.compressedPreview.innerHTML = `
            <div>✅ Compression Complete<br>
            <small>Size: ${(compressedSize/1024/1024).toFixed(2)} MB<br>
            Reduction: ${reduction}%<br>
            Quality: ${quality.value}%</small></div>
          `;
          
          item.status.textContent = `Compressed ${reduction}%`;
          item.status.className = 'status success';
          
        } catch(error){
          console.error('Compression failed:', error);
          item.status.textContent = 'Failed';
          item.status.className = 'status error';
          item.compressedPreview.innerHTML = '<div>❌ Compression failed</div>';
        } finally {
          item.progress.style.display = 'none';
        }
      }
      
      compressBtn.disabled = false;
      compressBtn.textContent = 'Compress All PDFs';
    });

    // Live preview on settings change (similar to image compressor)
    [quality, targetMB, imageQuality, compressionMode].forEach(el => 
      el.addEventListener('input', () => {
        if(items.length && items[0].compressedPreview){
          items[0].compressedPreview.innerHTML = `
            <div>🔄 Settings Changed<br>
            <small>Quality: ${quality.value}%<br>
            Target: ${targetMB.value || 'Auto'} MB<br>
            Mode: ${compressionMode.options[compressionMode.selectedIndex].text}<br>
            Click "Preview" to update</small></div>
          `;
        }
      })
    );

    // Feature detection
    if(!window.FileReader || typeof PDFLib === 'undefined'){
      const warning = document.createElement('div');
      warning.style.cssText = 'background:var(--warning);color:#fff;padding:1rem;border-radius:8px;margin-bottom:1rem;text-align:center';
      warning.innerHTML = '⚠️ Your browser may not fully support PDF compression. Please use the latest Chrome, Firefox, or Safari.';
      document.querySelector('.card').insertBefore(warning, drop);
    }
  </script>
</body>

</html>


